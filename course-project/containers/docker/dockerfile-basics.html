<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dockerfile: Building Custom Images :: Course Project</title>
    <link rel="canonical" href="https://feelpp.github.io/course-project/course-project/containers/docker/dockerfile-basics.html">
    <link rel="prev" href="docker-commands.html">
    <link rel="next" href="hands-on/04-compose.html">
    <meta name="description" content="Learn to create Dockerfiles to build custom container images for mathematical computing and research.">
    <meta name="generator" content="Antora 3.1.7">
<link rel="stylesheet" href="../../../_/css/site.css">

<!-- Font Awesome webfont CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <link rel="stylesheet" href="../../../_/css/listing.css">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
<script>!function(l,p){if(l.protocol!==p&&l.host=="docs.antora.org"){l.protocol=p}else if(/\.gitlab\.io$/.test(l.host)){l.replace(p+"//docs.antora.org"+l.pathname.substr(l.pathname.indexOf("/",1))+l.search+l.hash)}}(location,"https:")</script>

<script src="../../../_/js/vendor/tabs-block-extension.js"></script>
<script src="../../../_/js/vendor/tabs-block-behavior.js"></script>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true,
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },

  TeX: {
      Macros: {
      bold: ["{\\bf #1}",1],
      calTh: "{\\mathcal{T}_h}",
      card: ["{\\operatorname{card}(#1)}",1],
      card: ["{\\operatorname{card}(#1)}",1],
      Ck: ["{\\mathcal{C}^{#1}}",1],
      deformt: ["{\\mathbf{\\varepsilon(#1)}}",1],
      diam: "{\\operatorname{diam}}",
      dim: ["{\\operatorname{dim}(#1)}",1],
      disp: ["{\\mathbf{#1}}",1],
      domain: "{\\Omega}",
      ds: "",
      essinf: "{\\operatorname{ess}\\, \\operatorname{inf}}",
      F:"{\\mathcal{F}}",
      geo: "{\\mathrm{geo}}",
      Ich: ["{\\mathcal{I}^{#1}_{c,h}#2}",2],
      Id: "{\\mathcal{I}}",
      Ilag: ["{\\mathcal{I}^{\\mathrm{lag}}_{#1}}",1],
      jump: ["{[\\![ #1 ]\\!]}",1],
      n:"{\\mathbf{n}}",
      Ne: "{N_{\\mathrm{e}}}",
      Next: "{\\mathrm{n}}",
      nf: "{n_f}",
      ngeo: "{n_{\\mathrm{geo}}}",
      Nma: "{N_{\\mathrm{ma}}}",
      NN: "{\\mathbb N}",
      Nno: "{N_{\\mathrm{no}}}",
      Nso: "{N_{\\mathrm{so}}}",
      opdim: "{\\operatorname{dim}}",
      p: "{\\mathrm{p}}",
      P:"{\\mathcal{P}}",
      Pch: ["{P^{#1}_{c,h}}",1],
      Pcho: ["{P^{#1}_{c,h,0}}",1],
      Pk: ["{\\mathcal{P}^{#1}}",1],
      poly: ["{\\mathbb{#1}",1],
      poly: ["{\\mathbb{#1}}",1],
      prect: ["{\\left\\(#1\\right\\)}",1],
      q:"{\\mathbf{q}}",
      Qch: ["{Q^{#1}_{c,h}}",1],
      Qk: ["{\\mathcal{Q}^{#1}}",1],
      R: ["{\\mathbb{R}^{#1}}",1],
      RR: "{\\mathbb R}",
      set: ["{\\left\\{#1\\right\\}}",1],
      stresst: ["{\\mathbf{\\sigma(#1)}}",1],
      T:"{\\mathcal{T}}",
      tr: "{\\operatorname{tr}}",
      v:"{\\mathbf{v}}",
      vertiii: ["\\left\\vert\\kern-0.25ex\\left\\vert\\kern-0.25ex\\left\\vert #1 \\right\\vert\\kern-0.25ex\\right\\vert\\kern-0.25ex\\right\\vert",1]
  },
  extensions: ["mhchem.js"] 
  }
});
</script>
<!--<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script> -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS_CHTML'></script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>-->

<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>-->
<script>var uiRootPath = '../../../_'</script>

  </head>
  <body class="article">
<header class="header">
    <nav class="navbar navbar-expand-sm bg-dark navbar-dark navbar-template-project"
        style="border-top: 4px solid #9E9E9E">
        <div class="navbar-brand">
            <div class="navbar-item feelpp-logo">
                <a href="https://feelpp.github.io/course-project">Course Project</a>
            </div>
            <button class="navbar-burger" data-target="topbar-nav">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>

        <div id="topbar-nav" class="navbar-menu">
            <div class="navbar-end">
               <!--<div class="navbar-item">
                    <a href="../../../_/../cours-project/python/index.html">Documentation Reference</a>
                </div>-->
                <div class="navbar-item has-dropdown is-hoverable download-item">
                    <div class="navbar-item"><a href="../../../_/../cours-project/_attachments/cours-project.zip"
                            class="download-btn">Download the Notebooks</a></div>
                </div>
                <div class="navbar-item">
                    <a class="navbar-brand" href="https://www.cemosis.fr">
                        <img class="cemosis-logo" src="../../../_/img/cemosis-logo.svg" alt="Cemosis logo" />
                    </a>
                </div>
                <div class="navbar-item">
                    <a class="navbar-brand" href="https://www.unistra.fr">
                        <img class="cemosis-logo" src="../../../_/img/logo-unistra.png" alt="Unistra logo" />
                    </a>
                </div>
            </div>
        </div>
    </nav>
</header><div class="body">
<a href="#" class="menu-expand-toggle"></a>
<div class="nav-container" data-component="course-project" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Course Project</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../index.html">üè† Course Home</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../quick-start.html">üöÄ Quick Start Guide</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../prerequisites.html">üìã Prerequisites &amp; Self-Assessment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../instructor-guide.html">üìö Instructor Guide</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../linux/index.html">Linux</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü¢ Fundamentals</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../linux/shell.html">Shell Basics</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../linux/files.html">File Operations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../linux/editing.html">File Editing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../linux/text-processing.html">Text Processing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü° Remote Computing</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../linux/ssh/index.html">SSH Introduction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../linux/ssh/ssh-setup.html">SSH Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../linux/ssh/ssh-commands.html">SSH Commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../linux/ssh/remote-ssh-vscode.html">VS Code Remote-SSH</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../git-github/index.html">Git &amp; GitHub</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü¢ Git Fundamentals</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../git-github/git-starter.html">Git Starter Guide</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../git-github/git-repository-basics.html">Repository Basics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü¢ GitHub Basics</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../git-github/github-essentials.html">GitHub Essentials</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../git-github/github-start.html">Getting Started</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../git-github/github-how-to-write-issues.html">Writing Issues</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü° Collaboration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../git-github/git-branch.html">Git Branching</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../git-github/git-merges.html">Merging &amp; Conflicts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../git-github/git-remotes.html">Git Remotes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../git-github/github-collaborations.html">GitHub Collaboration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üî¥ Automation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../git-github/github-actions.html">GitHub Actions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../git-github/github-actions-cmake-eigen3.html">CMake + Eigen3 Example</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../vscode/index.html">VS Code</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü¢ Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../vscode/install.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../vscode/basic-usage.html">Basic Usage</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../vscode/extensions.html">Extensions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../vscode/configure-vscode.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../vscode/cheatsheet.html">Cheat Sheet</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../jupyter.html">Jupyter Notebooks</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Containers</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü° Docker Fundamentals</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="index.html">Docker Introduction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="what-are-containers.html">What are Containers?</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="docker-install.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="docker-commands.html">Essential Commands</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="dockerfile-basics.html">Dockerfile Basics</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hands-on/04-compose.html">Docker Compose</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hands-on/06-githubactions.html">Docker + GitHub Actions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üî¥ HPC Containers</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../hpc/index.html">HPC Containerization</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../apptainer/index.html">Apptainer/Singularity</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../apptainer/tutorial.html">Apptainer Tutorial</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../hpc/cicd.html">CI/CD for HPC</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../hpc/best-practices.html">HPC Best Practices</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../project-management/index.html">Project Management</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü° Fundamentals</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../project-management/introduction.html">What is a Project?</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../project-management/project-phases.html">Project Phases</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../project-management/practical-examples.html">Practical Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü° Tools &amp; Methods</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../project-management/tools-gantt.html">Tools &amp; Gantt Charts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../project-management/agile-best-practices.html">Agile Practices</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../project-management/github.html">GitHub for PM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../project-management/case-studies.html">Case Studies</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../cicd/index.html">CI/CD</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üî¥ Platforms</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../cicd/gitlab.html">GitLab CI/CD</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../cicd/gitlab_handson.html">GitLab Hands-on</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../software/index.html">Software Distribution</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üî¥ Topics</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../software/package-managers.html">Package Managers</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../software/repo/organization.html">Repository Organization</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../visualisation/index.html">Visualization</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üî¥ Web Dashboards</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../visualisation/dash.html">Dash Tutorial</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Course Project</span>
    <span class="version"></span>
  </div>
  <ul class="components">
      <li class="component is-current">
        <a class="title" href="../../index.html">Course Project</a>
      </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
    <a href="../../index.html" class="home-link"></a>
  <nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Course Project</a></li>
    <li><a href="../index.html">Containers</a></li>
    <li>üü° Docker Fundamentals</li>
    <li><a href="dockerfile-basics.html">Dockerfile Basics</a></li>
  </ul>
</nav>

  
    <div class="edit-this-page"><a href="https://github.com/feelpp/course-project/edit/master/docs/modules/containers/pages/docker/dockerfile-basics.adoc">Edit this Page</a></div>
  
  <div class="page-downloads">
  <span class="label">Download as</span>
  <ul class="download-options">
    <li>
      <a onclick="print(this)" href="#" data-toggle="tooltip" data-placement="left" title="Print to PDF"
         class="pdf-download">
        <img class="pdf-file-icon icon" src="../../../_/img/pdf.svg"/> .pdf
      </a>
    </li>
  </ul>
</div>
</div>

  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Dockerfile: Building Custom Images</h1>
<div id="preamble">
<div class="sectionbody">
<div class="exampleblock level-indicator bg-warning text-white p-3 rounded mb-4">
<div class="content">
<div class="paragraph">
<p><strong>üü° LEVEL 2</strong> | <strong>Time:</strong> 45 minutes | <strong>Prerequisites:</strong> Basic Docker commands</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_is_a_dockerfile"><a class="anchor" href="#_what_is_a_dockerfile"></a>1. What is a Dockerfile?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <strong>Dockerfile</strong> is a text file containing instructions to build a Docker image. Think of it as a recipe that Docker follows to create your container environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># Simple Dockerfile example
FROM python:3.11
RUN pip install numpy scipy matplotlib
COPY analysis.py /app/
WORKDIR /app
CMD ["python", "analysis.py"]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dockerfile_instructions"><a class="anchor" href="#_dockerfile_instructions"></a>2. Dockerfile Instructions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_from_base_image"><a class="anchor" href="#_from_base_image"></a>2.1. FROM - Base Image</h3>
<div class="paragraph">
<p>Every Dockerfile starts with <code>FROM</code>. It specifies the base image to build upon.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># Official Python image
FROM python:3.11

# Slim variant (smaller)
FROM python:3.11-slim

# Specific version with Debian
FROM python:3.11.7-bookworm

# Ubuntu base
FROM ubuntu:24.04</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Choosing a Base Image</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Base</th>
<th class="tableblock halign-left valign-top">Use Case</th>
<th class="tableblock halign-left valign-top">Size</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>python:3.11</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full development environment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">~1 GB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>python:3.11-slim</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Production, smaller footprint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">~150 MB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>python:3.11-alpine</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minimal, may have compatibility issues</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">~50 MB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ubuntu:24.04</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full control, install what you need</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">~80 MB</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_run_execute_commands"><a class="anchor" href="#_run_execute_commands"></a>2.2. RUN - Execute Commands</h3>
<div class="paragraph">
<p>Execute commands during image build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># Install system packages
RUN apt-get update &amp;&amp; apt-get install -y \
    build-essential \
    gfortran \
    libopenblas-dev \
    &amp;&amp; rm -rf /var/lib/apt/lists/*

# Install Python packages
RUN pip install --no-cache-dir \
    numpy==1.24.0 \
    scipy==1.10.0 \
    matplotlib==3.7.0

# Create directories
RUN mkdir -p /app/data /app/results</code></pre>
</div>
</div>
<div class="openblock callout tip">
<div class="content">
<div class="paragraph">
<p><strong>Best Practice</strong>: Combine related commands with <code>&amp;&amp;</code> to reduce layers. Clean up caches (<code>rm -rf /var/lib/apt/lists/*</code>, <code>--no-cache-dir</code>) to reduce image size.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_copy_and_add_add_files"><a class="anchor" href="#_copy_and_add_add_files"></a>2.3. COPY and ADD - Add Files</h3>
<div class="paragraph">
<p>Copy files from your local machine into the image:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># Copy single file
COPY requirements.txt /app/

# Copy directory contents
COPY src/ /app/src/

# Copy with different name
COPY local_config.yml /app/config.yml

# Copy multiple files
COPY script1.py script2.py /app/</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>ADD</code> has extra features (URL download, auto-extract tar), but <code>COPY</code> is preferred for clarity.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workdir_set_working_directory"><a class="anchor" href="#_workdir_set_working_directory"></a>2.4. WORKDIR - Set Working Directory</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">WORKDIR /app

# All subsequent commands run from /app
RUN pip install -r requirements.txt
COPY . .
CMD ["python", "main.py"]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_env_environment_variables"><a class="anchor" href="#_env_environment_variables"></a>2.5. ENV - Environment Variables</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># Set environment variables
ENV PYTHONUNBUFFERED=1
ENV PYTHONDONTWRITEBYTECODE=1
ENV APP_ENV=production

# Use variables
ENV DATA_DIR=/app/data
RUN mkdir -p $DATA_DIR</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_expose_document_ports"><a class="anchor" href="#_expose_document_ports"></a>2.6. EXPOSE - Document Ports</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># Document that container listens on port 8888
EXPOSE 8888

# Multiple ports
EXPOSE 8080 8443</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: <code>EXPOSE</code> is documentation only. You still need <code>-p</code> when running.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cmd_and_entrypoint_default_command"><a class="anchor" href="#_cmd_and_entrypoint_default_command"></a>2.7. CMD and ENTRYPOINT - Default Command</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># CMD: Default command (can be overridden)
CMD ["python", "main.py"]

# ENTRYPOINT: Fixed command
ENTRYPOINT ["python"]
CMD ["main.py"]  # Default argument, can be overridden</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the ENTRYPOINT example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run myimage              # Runs: python main.py
docker run myimage other.py     # Runs: python other.py</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_complete_dockerfile_examples"><a class="anchor" href="#_complete_dockerfile_examples"></a>3. Complete Dockerfile Examples</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_example_1_python_scientific_computing"><a class="anchor" href="#_example_1_python_scientific_computing"></a>3.1. Example 1: Python Scientific Computing</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># Dockerfile for numerical analysis with Python
FROM python:3.11-slim

# Install system dependencies for scientific libraries
RUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \
    build-essential \
    gfortran \
    libopenblas-dev \
    liblapack-dev \
    &amp;&amp; rm -rf /var/lib/apt/lists/*

# Set working directory
WORKDIR /app

# Install Python dependencies
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Copy application code
COPY src/ ./src/
COPY main.py .

# Environment variables
ENV PYTHONUNBUFFERED=1

# Default command
CMD ["python", "main.py"]</code></pre>
</div>
</div>
<div class="paragraph">
<p>With <code>requirements.txt</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">numpy==1.24.0
scipy==1.10.0
matplotlib==3.7.0
pandas==2.0.0</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_example_2_jupyter_notebook_environment"><a class="anchor" href="#_example_2_jupyter_notebook_environment"></a>3.2. Example 2: Jupyter Notebook Environment</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># Dockerfile for Jupyter-based mathematical research
FROM python:3.11

# Install Jupyter and scientific stack
RUN pip install --no-cache-dir \
    jupyterlab \
    numpy \
    scipy \
    matplotlib \
    sympy \
    pandas

# Create non-root user for security
RUN useradd -m -s /bin/bash researcher
USER researcher

# Set working directory
WORKDIR /home/researcher/notebooks

# Expose Jupyter port
EXPOSE 8888

# Start Jupyter Lab
CMD ["jupyter", "lab", "--ip=0.0.0.0", "--no-browser"]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_example_3_ccmake_mathematical_library"><a class="anchor" href="#_example_3_ccmake_mathematical_library"></a>3.3. Example 3: C++/CMake Mathematical Library</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># Dockerfile for C++ mathematical computing with Eigen
FROM ubuntu:24.04

# Install build tools and libraries
RUN apt-get update &amp;&amp; apt-get install -y \
    build-essential \
    cmake \
    git \
    libeigen3-dev \
    libboost-all-dev \
    &amp;&amp; rm -rf /var/lib/apt/lists/*

# Set working directory
WORKDIR /project

# Copy project files
COPY CMakeLists.txt .
COPY src/ ./src/
COPY include/ ./include/

# Build the project
RUN mkdir build &amp;&amp; cd build &amp;&amp; \
    cmake .. -DCMAKE_BUILD_TYPE=Release &amp;&amp; \
    make -j$(nproc)

# Set the built executable as entry point
ENTRYPOINT ["/project/build/mymath"]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_building_images"><a class="anchor" href="#_building_images"></a>4. Building Images</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_basic_build"><a class="anchor" href="#_basic_build"></a>4.1. Basic Build</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># Build from current directory (Dockerfile must exist)
docker build -t myimage .

# Build with specific Dockerfile
docker build -t myimage -f Dockerfile.dev .

# Build with tag/version
docker build -t myimage:v1.0 .
docker build -t myimage:latest .</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_build_context"><a class="anchor" href="#_build_context"></a>4.2. Build Context</h3>
<div class="paragraph">
<p>The <code>.</code> at the end specifies the <strong>build context</strong> - the directory containing files available to COPY/ADD.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># Build context is current directory
docker build -t myimage .

# Build context is parent directory
docker build -t myimage -f docker/Dockerfile ..</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dockerignore"><a class="anchor" href="#_dockerignore"></a>4.3. .dockerignore</h3>
<div class="paragraph">
<p>Create <code>.dockerignore</code> to exclude files from build context:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"># .dockerignore
.git
.gitignore
__pycache__
*.pyc
.venv
venv
*.egg-info
.pytest_cache
.mypy_cache
data/
results/
*.log
.DS_Store</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_multi_stage_builds"><a class="anchor" href="#_multi_stage_builds"></a>5. Multi-Stage Builds</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Reduce image size by separating build and runtime stages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># Stage 1: Build
FROM python:3.11 AS builder

WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir --target=/app/deps -r requirements.txt

# Stage 2: Runtime (smaller image)
FROM python:3.11-slim

WORKDIR /app

# Copy only the installed packages
COPY --from=builder /app/deps /usr/local/lib/python3.11/site-packages/

# Copy application
COPY src/ ./src/
COPY main.py .

CMD ["python", "main.py"]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_best_practices"><a class="anchor" href="#_best_practices"></a>6. Best Practices</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_1_order_instructions_by_change_frequency"><a class="anchor" href="#_1_order_instructions_by_change_frequency"></a>6.1. 1. Order Instructions by Change Frequency</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># Good: Rarely changing instructions first
FROM python:3.11
RUN apt-get update &amp;&amp; apt-get install -y build-essential

# Dependencies change sometimes
COPY requirements.txt .
RUN pip install -r requirements.txt

# Code changes frequently - put last!
COPY src/ ./src/</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_2_use_specific_versions"><a class="anchor" href="#_2_use_specific_versions"></a>6.2. 2. Use Specific Versions</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># Bad: Unpredictable
FROM python:latest
RUN pip install numpy

# Good: Reproducible
FROM python:3.11.7-slim
RUN pip install numpy==1.24.0</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_3_minimize_layers"><a class="anchor" href="#_3_minimize_layers"></a>6.3. 3. Minimize Layers</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># Bad: Multiple layers
RUN apt-get update
RUN apt-get install -y build-essential
RUN apt-get install -y cmake
RUN rm -rf /var/lib/apt/lists/*

# Good: Single layer
RUN apt-get update &amp;&amp; apt-get install -y \
    build-essential \
    cmake \
    &amp;&amp; rm -rf /var/lib/apt/lists/*</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_4_dont_run_as_root_production"><a class="anchor" href="#_4_dont_run_as_root_production"></a>6.4. 4. Don&#8217;t Run as Root (Production)</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile"># Create non-root user
RUN useradd -m -s /bin/bash appuser
USER appuser
WORKDIR /home/appuser/app</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hands_on_exercise"><a class="anchor" href="#_hands_on_exercise"></a>7. Hands-On Exercise</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Create a Dockerfile for a numerical analysis project:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a project directory:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">mkdir docker-math-demo &amp;&amp; cd docker-math-demo</code></pre>
</div>
</div>
</li>
<li>
<p>Create <code>requirements.txt</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">numpy==1.24.0
scipy==1.10.0
matplotlib==3.7.0</code></pre>
</div>
</div>
</li>
<li>
<p>Create <code>analysis.py</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import numpy as np
from scipy import integrate
import matplotlib.pyplot as plt

# Numerical integration example
f = lambda x: np.sin(x) * np.exp(-x)
result, error = integrate.quad(f, 0, np.pi)
print(f"Integral result: {result:.6f} ¬± {error:.2e}")

# Generate plot
x = np.linspace(0, np.pi, 100)
plt.figure(figsize=(8, 5))
plt.plot(x, f(x), 'b-', linewidth=2)
plt.fill_between(x, f(x), alpha=0.3)
plt.title(f'‚à´sin(x)e^(-x)dx from 0 to œÄ = {result:.4f}')
plt.xlabel('x')
plt.ylabel('f(x)')
plt.savefig('/output/integral_plot.png', dpi=150)
print("Plot saved to /output/integral_plot.png")</code></pre>
</div>
</div>
</li>
<li>
<p>Create <code>Dockerfile</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY analysis.py .

RUN mkdir /output
VOLUME /output

CMD ["python", "analysis.py"]</code></pre>
</div>
</div>
</li>
<li>
<p>Build and run:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker build -t math-demo .
docker run -v $(pwd)/output:/output math-demo
ls output/  # Should see integral_plot.png</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps"><a class="anchor" href="#_next_steps"></a>8. Next Steps</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="hands-on/06-githubactions.html" class="xref page">Automate builds with GitHub Actions</a></p>
</li>
<li>
<p>Learn <a href="hands-on/04-compose.html" class="xref page">Docker Compose</a> for multi-container setups</p>
</li>
<li>
<p>Explore <a href="../hpc/index.html" class="xref page">containers on HPC</a> with Apptainer</p>
</li>
</ol>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="docker-commands.html">Essential Commands</a></span>
  <span class="next"><a href="hands-on/04-compose.html">Docker Compose</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer"
    style="border-top: 2px solid #e9e9e9; background-color: #fafafa; padding-bottom: 2em; padding-top: 2em;">
    <div class="container" style="display: flex; flex-direction: column; align-items: center; gap: 0.5em;">
        <div>
            <a href="https://www.cemosis.fr">
                <img src="../../../_/img/cemosis-logo.svg" alt="Cemosis logo" height="50">
            </a>
            &nbsp;&nbsp;&nbsp;&nbsp;
            <a href="https://www.unistra.fr">
                <img src="../../../_/img/logo-unistra.png" alt="Unistra logo" height="50">
            </a>
        </div>
        <span style="font-size: 0.8rem; color: #9e9e9e">¬© 2026 <a href="https://www.cemosis.fr"
                style="text-decoration: underline;">Cemosis</a>, Universit√© de Strasbourg</span>
    </div>
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>


<!-- Font Awesome JS removed to use webfont icons only -->
<script async src="../../../_/js/vendor/highlight.js"></script>

<script src="../../../_/js/vendor/lunr.js"></script>

<script type="text/javascript">
function toggleFullScreen() {
   var doc = window.document;
   var docEl = doc.documentElement;

   var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;
   var cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;

   if(!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {
       requestFullScreen.call(docEl);
   }
   else {
       cancelFullScreen.call(doc);
   }
}
</script>
  </body>
</html>
