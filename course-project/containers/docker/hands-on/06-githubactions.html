<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tutorial: Building Docker Images Using GitHub Actions :: Course Project</title>
    <link rel="canonical" href="https://feelpp.github.io/course-project/course-project/containers/docker/hands-on/06-githubactions.html">
    <link rel="prev" href="04-compose.html">
    <link rel="next" href="../../hpc/index.html">
    <meta name="generator" content="Antora 3.1.7">
<link rel="stylesheet" href="../../../../_/css/site.css">

<!-- Font Awesome webfont CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <link rel="stylesheet" href="../../../../_/css/listing.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
<script>!function(l,p){if(l.protocol!==p&&l.host=="docs.antora.org"){l.protocol=p}else if(/\.gitlab\.io$/.test(l.host)){l.replace(p+"//docs.antora.org"+l.pathname.substr(l.pathname.indexOf("/",1))+l.search+l.hash)}}(location,"https:")</script>

<script src="../../../../_/js/vendor/tabs-block-extension.js"></script>
<script src="../../../../_/js/vendor/tabs-block-behavior.js"></script>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true,
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },

  TeX: {
      Macros: {
      bold: ["{\\bf #1}",1],
      calTh: "{\\mathcal{T}_h}",
      card: ["{\\operatorname{card}(#1)}",1],
      card: ["{\\operatorname{card}(#1)}",1],
      Ck: ["{\\mathcal{C}^{#1}}",1],
      deformt: ["{\\mathbf{\\varepsilon(#1)}}",1],
      diam: "{\\operatorname{diam}}",
      dim: ["{\\operatorname{dim}(#1)}",1],
      disp: ["{\\mathbf{#1}}",1],
      domain: "{\\Omega}",
      ds: "",
      essinf: "{\\operatorname{ess}\\, \\operatorname{inf}}",
      F:"{\\mathcal{F}}",
      geo: "{\\mathrm{geo}}",
      Ich: ["{\\mathcal{I}^{#1}_{c,h}#2}",2],
      Id: "{\\mathcal{I}}",
      Ilag: ["{\\mathcal{I}^{\\mathrm{lag}}_{#1}}",1],
      jump: ["{[\\![ #1 ]\\!]}",1],
      n:"{\\mathbf{n}}",
      Ne: "{N_{\\mathrm{e}}}",
      Next: "{\\mathrm{n}}",
      nf: "{n_f}",
      ngeo: "{n_{\\mathrm{geo}}}",
      Nma: "{N_{\\mathrm{ma}}}",
      NN: "{\\mathbb N}",
      Nno: "{N_{\\mathrm{no}}}",
      Nso: "{N_{\\mathrm{so}}}",
      opdim: "{\\operatorname{dim}}",
      p: "{\\mathrm{p}}",
      P:"{\\mathcal{P}}",
      Pch: ["{P^{#1}_{c,h}}",1],
      Pcho: ["{P^{#1}_{c,h,0}}",1],
      Pk: ["{\\mathcal{P}^{#1}}",1],
      poly: ["{\\mathbb{#1}",1],
      poly: ["{\\mathbb{#1}}",1],
      prect: ["{\\left\\(#1\\right\\)}",1],
      q:"{\\mathbf{q}}",
      Qch: ["{Q^{#1}_{c,h}}",1],
      Qk: ["{\\mathcal{Q}^{#1}}",1],
      R: ["{\\mathbb{R}^{#1}}",1],
      RR: "{\\mathbb R}",
      set: ["{\\left\\{#1\\right\\}}",1],
      stresst: ["{\\mathbf{\\sigma(#1)}}",1],
      T:"{\\mathcal{T}}",
      tr: "{\\operatorname{tr}}",
      v:"{\\mathbf{v}}",
      vertiii: ["\\left\\vert\\kern-0.25ex\\left\\vert\\kern-0.25ex\\left\\vert #1 \\right\\vert\\kern-0.25ex\\right\\vert\\kern-0.25ex\\right\\vert",1]
  },
  extensions: ["mhchem.js"] 
  }
});
</script>
<!--<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script> -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS_CHTML'></script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>-->

<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>-->
<script>var uiRootPath = '../../../../_'</script>

  </head>
  <body class="article">
<header class="header">
    <nav class="navbar navbar-expand-sm bg-dark navbar-dark navbar-template-project"
        style="border-top: 4px solid #9E9E9E">
        <div class="navbar-brand">
            <div class="navbar-item feelpp-logo">
                <a href="https://feelpp.github.io/course-project">Course Project</a>
            </div>
            <button class="navbar-burger" data-target="topbar-nav">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>

        <div id="topbar-nav" class="navbar-menu">
            <div class="navbar-end">
               <!--<div class="navbar-item">
                    <a href="../../../../_/../cours-project/python/index.html">Documentation Reference</a>
                </div>-->
                <div class="navbar-item has-dropdown is-hoverable download-item">
                    <div class="navbar-item"><a href="../../../../_/../cours-project/_attachments/cours-project.zip"
                            class="download-btn">Download the Notebooks</a></div>
                </div>
                <div class="navbar-item">
                    <a class="navbar-brand" href="https://www.cemosis.fr">
                        <img class="cemosis-logo" src="../../../../_/img/cemosis-logo.svg" alt="Cemosis logo" />
                    </a>
                </div>
                <div class="navbar-item">
                    <a class="navbar-brand" href="https://www.unistra.fr">
                        <img class="cemosis-logo" src="../../../../_/img/logo-unistra.png" alt="Unistra logo" />
                    </a>
                </div>
            </div>
        </div>
    </nav>
</header><div class="body">
<a href="#" class="menu-expand-toggle"></a>
<div class="nav-container" data-component="course-project" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../index.html">Course Project</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../index.html">üè† Course Home</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../quick-start.html">üöÄ Quick Start Guide</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../prerequisites.html">üìã Prerequisites &amp; Self-Assessment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../instructor-guide.html">üìö Instructor Guide</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../linux/index.html">Linux</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü¢ Fundamentals</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../linux/shell.html">Shell Basics</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../linux/files.html">File Operations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../linux/editing.html">File Editing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../linux/text-processing.html">Text Processing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü° Remote Computing</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../linux/ssh/index.html">SSH Introduction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../linux/ssh/ssh-setup.html">SSH Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../linux/ssh/ssh-commands.html">SSH Commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../linux/ssh/remote-ssh-vscode.html">VS Code Remote-SSH</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../git-github/index.html">Git &amp; GitHub</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü¢ Git Fundamentals</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../git-github/git-starter.html">Git Starter Guide</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../git-github/git-repository-basics.html">Repository Basics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü¢ GitHub Basics</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../git-github/github-essentials.html">GitHub Essentials</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../git-github/github-start.html">Getting Started</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../git-github/github-how-to-write-issues.html">Writing Issues</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü° Collaboration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../git-github/git-branch.html">Git Branching</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../git-github/git-merges.html">Merging &amp; Conflicts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../git-github/git-remotes.html">Git Remotes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../git-github/github-collaborations.html">GitHub Collaboration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../git-github/github-review-projects-lab.html">GitHub Review Lab: Projects</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üî¥ Automation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../git-github/github-actions.html">GitHub Actions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../git-github/github-actions-cmake-eigen3.html">CMake + Eigen3 Example</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../vscode/index.html">VS Code</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü¢ Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../vscode/install.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../vscode/basic-usage.html">Basic Usage</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../vscode/extensions.html">Extensions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../vscode/configure-vscode.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../vscode/cheatsheet.html">Cheat Sheet</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../jupyter.html">Jupyter Notebooks</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../index.html">Containers</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü° Docker Fundamentals</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../index.html">Docker Introduction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../what-are-containers.html">What are Containers?</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../docker-install.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../docker-commands.html">Essential Commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../dockerfile-basics.html">Dockerfile Basics</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-compose.html">Docker Compose</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="06-githubactions.html">Docker + GitHub Actions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üî¥ HPC Containers</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../hpc/index.html">HPC Containerization</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../apptainer/index.html">Apptainer/Singularity</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../apptainer/tutorial.html">Apptainer Tutorial</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../hpc/cicd.html">CI/CD for HPC</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../hpc/best-practices.html">HPC Best Practices</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../project-management/index.html">Project Management</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü° Fundamentals</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../project-management/introduction.html">What is a Project?</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../project-management/project-phases.html">Project Phases</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../project-management/practical-examples.html">Practical Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üü° Tools &amp; Methods</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../project-management/tools-gantt.html">Tools &amp; Gantt Charts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../project-management/agile-best-practices.html">Agile Practices</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../project-management/github.html">GitHub for PM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../project-management/case-studies.html">Case Studies</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../cicd/index.html">CI/CD</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üî¥ Platforms</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../cicd/gitlab.html">GitLab CI/CD</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../cicd/gitlab_handson.html">GitLab Hands-on</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../software/index.html">Software Distribution</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üî¥ Topics</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../software/package-managers.html">Package Managers</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../software/repo/organization.html">Repository Organization</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../visualisation/index.html">Visualization</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">üî¥ Web Dashboards</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../visualisation/dash.html">Dash Tutorial</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Course Project</span>
    <span class="version"></span>
  </div>
  <ul class="components">
      <li class="component is-current">
        <a class="title" href="../../../index.html">Course Project</a>
      </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
    <a href="../../../index.html" class="home-link"></a>
  <nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../index.html">Course Project</a></li>
    <li><a href="../../index.html">Containers</a></li>
    <li>üü° Docker Fundamentals</li>
    <li><a href="06-githubactions.html">Docker + GitHub Actions</a></li>
  </ul>
</nav>

  
    <div class="edit-this-page"><a href="https://github.com/feelpp/course-project/edit/master/docs/modules/containers/pages/docker/hands-on/06-githubactions.adoc">Edit this Page</a></div>
  
  <div class="page-downloads">
  <span class="label">Download as</span>
  <ul class="download-options">
    <li>
      <a onclick="print(this)" href="#" data-toggle="tooltip" data-placement="left" title="Print to PDF"
         class="pdf-download">
        <img class="pdf-file-icon icon" src="../../../../_/img/pdf.svg"/> .pdf
      </a>
    </li>
  </ul>
</div>
</div>

  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Tutorial: Building Docker Images Using GitHub Actions</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial will guide you through building and pushing Docker images using GitHub Actions. You‚Äôll learn how to use GitHub Actions to set up QEMU, Docker Buildx, and push images to the GitHub Container Registry (GHCR).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>1. Prerequisites</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A GitHub repository.</p>
</li>
<li>
<p>A Dockerfile for the service you want to build.</p>
</li>
<li>
<p>Access to the GitHub Container Registry (GHCR).</p>
</li>
<li>
<p>A GitHub personal access token (PAT) stored as a secret in your repository (<code>CR_PAT</code>).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_step_by_step_guide"><a class="anchor" href="#_step_by_step_guide"></a>2. Step-by-Step Guide</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_1_setting_up_the_github_workflow"><a class="anchor" href="#_1_setting_up_the_github_workflow"></a>2.1. 1. Setting Up the GitHub Workflow</h3>
<div class="paragraph">
<p>Create a file called <code>.github/workflows/docker-build.yml</code> in your repository. This file will define the workflow to build and push Docker images using GitHub Actions.</p>
</div>
<div class="sect3">
<h4 id="_example_github_actions_workflow"><a class="anchor" href="#_example_github_actions_workflow"></a>2.1.1. Example GitHub Actions Workflow</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">name: Build and Push Docker Image

on:
  push:
    branches:
      - main
    tags:
      - 'v*'

jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        service: [service-name]
        tag: [latest, v1.0.0]
        dir: [path-to-dockerfile-directory]
        dist: [ubuntu, debian]
        flavor: [base-image-flavor]
        version: [1.0.0]
        dockerfile: [Dockerfile]

    steps:
      # Step 1: Set up QEMU (for multi-platform builds)
      - name: Set up QEMU
        uses: docker/setup-qemu-action@v3

      # Step 2: Set up Docker Buildx (for advanced Docker builds)
      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      # Step 3: Login to GitHub Container Registry
      - name: Login to GitHub Container Registry
        uses: docker/login-action@v3
        with:
          registry: ghcr.io
          username: ${{ github.repository_owner }}
          password: ${{ secrets.CR_PAT }}

      # Step 4: Build and push the main Docker image
      - name: Build ${{ matrix.service }}:${{ matrix.tag }}
        uses: docker/build-push-action@v6
        with:
          context: ${{ matrix.dir }}
          tags: ghcr.io/${{ github.repository_owner }}/${{ matrix.service }}:${{ matrix.tag }},
                ghcr.io/${{ github.repository_owner }}/${{ matrix.service }}:${{ matrix.dist }}
          file: ${{ matrix.dir }}/${{ matrix.dockerfile }}
          build-args: |
            IMAGE=${{ matrix.flavor }}:${{ matrix.dist }}
            FLAVOR=${{ matrix.flavor }}
            DIST=${{ matrix.dist }}
            VERSION=${{ matrix.version }}
          push: true
          secrets: |
            GIT_AUTH_TOKEN=${{ secrets.CR_PAT }}

      # Step 5: Build and push the development Docker image
      - name: Build ${{ matrix.service }}-dev:${{ matrix.tag }}
        uses: docker/build-push-action@v6
        with:
          context: ${{ matrix.dir }}
          tags: ghcr.io/${{ github.repository_owner }}/${{ matrix.service }}-dev:${{ matrix.tag }},
                ghcr.io/${{ github.repository_owner }}/${{ matrix.service }}-dev:${{ matrix.dist }}
          file: ${{ matrix.dir }}/${{ matrix.dockerfile }}-dev
          build-args: TAG=${{ matrix.tag }}
          push: true
          secrets: |
            GIT_AUTH_TOKEN=${{ secrets.CR_PAT }}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_by_step_breakdown"><a class="anchor" href="#_step_by_step_breakdown"></a>2.2. Step-by-Step Breakdown:</h3>
<div class="sect3">
<h4 id="_1_set_up_qemu_for_multi_platform_builds"><a class="anchor" href="#_1_set_up_qemu_for_multi_platform_builds"></a>2.2.1. 1. Set up QEMU for Multi-Platform Builds</h4>
<div class="paragraph">
<p>The <code>docker/setup-qemu-action</code> sets up QEMU, which allows you to build Docker images for multiple platforms like <code>amd64</code>, <code>arm64</code>, etc.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- name: Set up QEMU
  uses: docker/setup-qemu-action@v3</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_2_set_up_docker_buildx"><a class="anchor" href="#_2_set_up_docker_buildx"></a>2.2.2. 2. Set up Docker Buildx</h4>
<div class="paragraph">
<p>The <code>docker/setup-buildx-action</code> sets up Buildx, Docker&#8217;s advanced build tool, which supports multi-platform builds and other features like build caching.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- name: Set up Docker Buildx
  uses: docker/setup-buildx-action@v3</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_3_login_to_github_container_registry_ghcr"><a class="anchor" href="#_3_login_to_github_container_registry_ghcr"></a>2.2.3. 3. Login to GitHub Container Registry (GHCR)</h4>
<div class="paragraph">
<p>This step logs into the GitHub Container Registry using the <code>docker/login-action</code>. You need to provide your GitHub username and a GitHub personal access token (PAT) stored in the secret <code>CR_PAT</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- name: Login to GitHub Container Registry
  uses: docker/login-action@v3
  with:
    registry: ghcr.io
    username: ${{ github.repository_owner }}
    password: ${{ secrets.CR_PAT }}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_4_build_and_push_the_main_docker_image"><a class="anchor" href="#_4_build_and_push_the_main_docker_image"></a>2.2.4. 4. Build and Push the Main Docker Image</h4>
<div class="paragraph">
<p>This step builds the Docker image using the context and Dockerfile specified in the matrix. The image is tagged and pushed to GHCR.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- name: Build ${{ matrix.service }}:${{ matrix.tag }}
  uses: docker/build-push-action@v6
  with:
    context: ${{ matrix.dir }}
    tags: ghcr.io/${{ github.repository_owner }}/${{ matrix.service }}:${{ matrix.tag }},
          ghcr.io/${{ github.repository_owner }}/${{ matrix.service }}:${{ matrix.dist }}
    file: ${{ matrix.dir }}/${{ matrix.dockerfile }}
    platforms: linux/amd64,linux/arm64
    build-args: |
      IMAGE=${{ matrix.flavor }}:${{ matrix.dist }}
      FLAVOR=${{ matrix.flavor }}
      DIST=${{ matrix.dist }}
      VERSION=${{ matrix.version }}
    push: true
    secrets: |
      GIT_AUTH_TOKEN=${{ secrets.CR_PAT }}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>context</strong>: The directory containing the Dockerfile and other necessary files.</p>
</li>
<li>
<p><strong>tags</strong>: The tags used to label the image in the registry.</p>
</li>
<li>
<p><strong>build-args</strong>: These arguments are passed to the <code>Dockerfile</code>.</p>
</li>
<li>
<p><strong>push</strong>: Specifies whether to push the image to the registry.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_5_build_and_push_the_development_docker_image"><a class="anchor" href="#_5_build_and_push_the_development_docker_image"></a>2.2.5. 5. Build and Push the Development Docker Image</h4>
<div class="paragraph">
<p>This step builds and pushes the development version of the Docker image.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- name: Build ${{ matrix.service }}-dev:${{ matrix.tag }}
  uses: docker/build-push-action@v6
  with:
    context: ${{ matrix.dir }}
    tags: ghcr.io/${{ github.repository_owner }}/${{ matrix.service }}-dev:${{ matrix.tag }},
          ghcr.io/${{ github.repository_owner }}/${{ matrix.service }}-dev:${{ matrix.dist }}
    file: ${{ matrix.dir }}/${{ matrix.dockerfile }}-dev
    platforms: linux/amd64,linux/arm64
    build-args: TAG=${{ matrix.tag }}
    push: true
    secrets: |
      GIT_AUTH_TOKEN=${{ secrets.CR_PAT }}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_multi_platform_builds"><a class="anchor" href="#_multi_platform_builds"></a>2.2.6. Multi-Platform Builds</h4>
<div class="literalblock">
<div class="content">
<pre>Docker supports  Multiple Architectures*. In this step, we build the Docker images for both `amd64` and `arm64` platforms using the `platforms` option:</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">platforms: linux/amd64,linux/arm64</code></pre>
</div>
</div>
<div class="paragraph">
<p>This ensures that the images are built for both architectures.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_2_setting_up_github_secrets"><a class="anchor" href="#_2_setting_up_github_secrets"></a>2.3. 2. Setting Up GitHub Secrets</h3>
<div class="paragraph">
<p>You‚Äôll need to add a GitHub secret for your personal access token to authenticate with the GitHub Container Registry.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to your GitHub repository.</p>
</li>
<li>
<p>Click on <strong>Settings</strong> &gt; <strong>Secrets and variables</strong> &gt; <strong>Actions</strong>.</p>
</li>
<li>
<p>Click <strong>New repository secret</strong>.</p>
</li>
<li>
<p>Add the secret <code>CR_PAT</code> with your GitHub personal access token.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example"><a class="anchor" href="#_example"></a>3. Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you&#8217;re building a service like <code>feelpp</code>, the configuration would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">strategy:
  matrix:
    service: [feelpp]
    tag: [latest, v1.0.0]
    dir: [docker]
    dist: [noble]
    flavor: [ubuntu]
    version: [1.0.0]
    dockerfile: [Dockerfile]</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this setup, Docker images for both <code>amd64</code> and <code>arm64</code> platforms will be built and pushed to GHCR with tags such as <code>ghcr.io/feelpp/feelpp:v1.0.0</code> and <code>ghcr.io/feelpp/feelpp:latest</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion"><a class="anchor" href="#_conclusion"></a>4. Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial demonstrates how to use GitHub Actions to build and push Docker images to the GitHub Container Registry using QEMU for multi-platform builds and Docker Buildx for enhanced build capabilities.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="04-compose.html">Docker Compose</a></span>
  <span class="next"><a href="../../hpc/index.html">HPC Containerization</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer"
    style="border-top: 2px solid #e9e9e9; background-color: #fafafa; padding-bottom: 2em; padding-top: 2em;">
    <div class="container" style="display: flex; flex-direction: column; align-items: center; gap: 0.5em;">
        <div>
            <a href="https://www.cemosis.fr">
                <img src="../../../../_/img/cemosis-logo.svg" alt="Cemosis logo" height="50">
            </a>
            &nbsp;&nbsp;&nbsp;&nbsp;
            <a href="https://www.unistra.fr">
                <img src="../../../../_/img/logo-unistra.png" alt="Unistra logo" height="50">
            </a>
        </div>
        <span style="font-size: 0.8rem; color: #9e9e9e">¬© 2026 <a href="https://www.cemosis.fr"
                style="text-decoration: underline;">Cemosis</a>, Universit√© de Strasbourg</span>
    </div>
</footer><script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>


<!-- Font Awesome JS removed to use webfont icons only -->
<script async src="../../../../_/js/vendor/highlight.js"></script>

<script src="../../../../_/js/vendor/lunr.js"></script>

<script type="text/javascript">
function toggleFullScreen() {
   var doc = window.document;
   var docEl = doc.documentElement;

   var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;
   var cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;

   if(!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {
       requestFullScreen.call(docEl);
   }
   else {
       cancelFullScreen.call(doc);
   }
}
</script>
  </body>
</html>
